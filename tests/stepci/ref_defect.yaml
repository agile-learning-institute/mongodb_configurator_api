version: "1.1"
name: Test Ref Defect - Schema Rendering with Ref Types
env:
  host: localhost:8081

tests:
  ref_defect:
    name: Test Ref Defect Schema Rendering
    steps:
      # Test JSON Schema rendering for test.yaml version 1.0.0.0
      # This should now succeed after fixing the ref type bug
      - name: Render JSON Schema for test.1.0.0.0
        http:
          url: http://${{env.host}}/api/configurations/json_schema/test.yaml/1.0.0.0/
          method: GET
          check:
            status: /200/
            schema:
              type: object
              properties:
                type:
                  type: string
                properties:
                  type: object

      # Test BSON Schema rendering for test.yaml version 1.0.0.0
      - name: Render BSON Schema for test.1.0.0.0
        http:
          url: http://${{env.host}}/api/configurations/bson_schema/test.yaml/1.0.0.0/
          method: GET
          check:
            status: /200/
            schema:
              type: object
              properties:
                bsonType:
                  type: string
                properties:
                  type: object

